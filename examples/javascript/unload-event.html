<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>Browser Close/Unload Event</title>
    <link rel="stylesheet" href="./css/bootstrap.min.css" />

    <style>
        body {
            background-color: #eeeeee;
        }
    </style>
</head>

<body>
    <main class="container">

    </main>

    <b>Detect browser or tab closing</b>

    <p>
        The beforeunload function is triggered
        just before the browser or tab is to be
        closed or the page is to be reloaded.
        Modern browsers require some interaction
        with the page, otherwise the dialog box
        is not shown.
    </p>

    <!--<form>
        <textarea placeholder="Trigger an
         interaction by writing something here">
        </textarea>
    </form>-->

    <script src="./js/jquery.min.js"></script>
    <script src="./js/bootstrap.bundle.min.js"></script>

    <script>
	// https://stackoverflow.com/questions/6162188/javascript-browsers-window-close-send-an-ajax-request-or-run-a-script-on-win
        document.addEventListener('DOMContentLoaded', (event) => {

        });

        window.addEventListener('beforeunload', function (e) {
fetch('https://jsonplaceholder.typicode.com/todos/1')
  .then(response => response.json())
  .then(json => console.log(json))
            e.preventDefault();
            e.returnValue = '';
        });
		
		window.addEventListener('unload', function (e) {
		// https://jsonplaceholder.typicode.com/users
fetch('https://jsonplaceholder.typicode.com/todos/1')
  .then(response => response.json())
  .then(json => console.log(json))
            e.preventDefault();
            e.returnValue = '';
        });
		
		window.unload=function () {
var result=confirm ("whether you want to leave this page");
if(result) {
alert("Thank you for visiting");
} else {
alert("Thank you for staying with us");
}
}

        function getRecordById(recordId) {
            console.log('getRecordById :', recordId);

            return fetch(`${this.API_URL}/${recordId}`)
                .then((response) => {
                    // If error then exit
                    if (response.status !== 200) {
                        console.log('Looks like there was a problem. Status Code: ' + response.status);
                        return;
                    }

                    // Examine the text in the response
                    this.articles = response.json();
                    return this.articles;
                });
        }
    </script>


</body>

</html>
